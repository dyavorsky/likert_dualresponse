<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.5">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prachi Bhalerao">
<meta name="author" content="Dan Yavorsky">
<meta name="author" content="Geoffery Zheng">
<meta name="dcterms.date" content="2024-08-22">
<meta name="keywords" content="choice-based conjoint analysis, stated preference elicitation, discrete choice methods, ordered choice">

<title>Outside Good Uncertainty</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="Outside Good Uncertainty">
<meta name="citation_abstract" content="We provide a behavioral model in which consumers are able to identify their most-preferred option among a set of alternatives, but face uncertainty in their evalulation of the outside good. The model rationalizes the use of a dual-response framework in choice-based conjoint analysis and extends the evaluation of the purchase decision from binary to ordinal.  A simulation study provides estimation routines for aggregate and Hierarhical Bayesian versions of the model, and demonstrates the model&amp;amp;#039;s superior performance compared with the binary and heuristic approaches currently used by practioners. We also provide an empirical example from a choice-based conjoint analysis conducted in partnership with a consumer insights consultancy.
">
<meta name="citation_keywords" content="choice-based conjoint analysis, stated preference elicitation, discrete choice methods, ordered choice">
<meta name="citation_author" content="Prachi Bhalerao">
<meta name="citation_author" content="Dan Yavorsky">
<meta name="citation_author" content="Geoffery Zheng">
<meta name="citation_publication_date" content="2024-08-22">
<meta name="citation_cover_date" content="2024-08-22">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-08-22">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Structural analysis of discrete data with econometric applications;,citation_author=Charles F. Manski;,citation_author=Daniel McFadden;,citation_publication_date=1981;,citation_cover_date=1981;,citation_year=1981;,citation_isbn=9780262131599;">
<meta name="citation_reference" content="citation_title=Structural discrete probability models derived from theories of choice;,citation_author=Daniel L. McFadden;,citation_publication_date=1981;,citation_cover_date=1981;,citation_year=1981;,citation_isbn=9780262131599;,citation_inbook_title=undefined;">
<meta name="citation_reference" content="citation_title=Variance components structures for the extreme-value and logistic distributions with application to models of heterogeneity;,citation_author=N. Scott Cardell;,citation_publication_date=1997-04;,citation_cover_date=1997-04;,citation_year=1997;,citation_issue=2;,citation_doi=10.1017/s0266466600005727;,citation_issn=1469-4360;,citation_volume=13;,citation_journal_title=Econometric Theory;,citation_publisher=Cambridge University Press (CUP);">
<meta name="citation_reference" content="citation_title=The no-choice option and dual response choice designs;,citation_author=Jeff D. Brazell;,citation_author=Christopher G. Diener;,citation_author=Ekaterina Karniouchina;,citation_author=William L. Moore;,citation_author=Válerie Séverin;,citation_author=Pierre-Francois Uldry;,citation_publication_date=2006-12;,citation_cover_date=2006-12;,citation_year=2006;,citation_fulltext_html_url=http://dx.doi.org/10.1007/s11002-006-7943-8;,citation_issue=4;,citation_doi=10.1007/s11002-006-7943-8;,citation_issn=1573-059X;,citation_volume=17;,citation_journal_title=Marketing Letters;,citation_publisher=Springer Science; Business Media LLC;">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Outside Good Uncertainty</h1>
            <p class="subtitle lead">Ordinal Dual Response in Choice-Based Conjoint Analysis</p>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliations</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Prachi Bhalerao <a href="mailto:prachipbhalerao@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        GBK Collective
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Dan Yavorsky <a href="mailto:dyavorsky@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-4095-6405" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        GBK Collective
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Geoffery Zheng <a href="mailto:gxz206@nyu.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-4229-8231" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        New York University, Shanghai
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">August 22, 2024</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></p></div></div></div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>We provide a behavioral model in which consumers are able to identify their most-preferred option among a set of alternatives, but face uncertainty in their evalulation of the outside good. The model rationalizes the use of a dual-response framework in choice-based conjoint analysis and extends the evaluation of the purchase decision from binary to ordinal. A simulation study provides estimation routines for aggregate and Hierarhical Bayesian versions of the model, and demonstrates the model’s superior performance compared with the binary and heuristic approaches currently used by practioners. We also provide an empirical example from a choice-based conjoint analysis conducted in partnership with a consumer insights consultancy.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>choice-based conjoint analysis, stated preference elicitation, discrete choice methods, ordered choice</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-intro" id="toc-sec-intro" class="nav-link active" data-scroll-target="#sec-intro"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#sec-model" id="toc-sec-model" class="nav-link" data-scroll-target="#sec-model"><span class="header-section-number">2</span> Model</a>
  <ul class="collapse">
  <li><a href="#set-up" id="toc-set-up" class="nav-link" data-scroll-target="#set-up"><span class="header-section-number">2.1</span> Set Up</a></li>
  <li><a href="#probability-specification" id="toc-probability-specification" class="nav-link" data-scroll-target="#probability-specification"><span class="header-section-number">2.2</span> Probability Specification</a></li>
  </ul></li>
  <li><a href="#sec-simstudy" id="toc-sec-simstudy" class="nav-link" data-scroll-target="#sec-simstudy"><span class="header-section-number">3</span> Simulation Study</a></li>
  <li><a href="#sec-analysis" id="toc-sec-analysis" class="nav-link" data-scroll-target="#sec-analysis"><span class="header-section-number">4</span> Empirical Analysis</a></li>
  <li><a href="#sec-discussion" id="toc-sec-discussion" class="nav-link" data-scroll-target="#sec-discussion"><span class="header-section-number">5</span> Discussion</a></li>
  <li><a href="#sec-conclusion" id="toc-sec-conclusion" class="nav-link" data-scroll-target="#sec-conclusion"><span class="header-section-number">6</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="notebooks/example_discretechoice-preview.html"><i class="bi bi-journal-code"></i>Discrete Choice</a></li><li><a href="notebooks/example_likert-preview.html"><i class="bi bi-journal-code"></i>Likert Scale Dual Response</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<!-- Latex -->
<p><span class="math display">\[
  \newcommand{\x}{\mathbf{x}}
  \newcommand{\bfbeta}{\boldsymbol{\beta}}
  \newcommand{\iid}{\stackrel{iid}{\sim}}
\]</span></p>
<!-- Sections -->
<section id="sec-intro" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="sec-intro"><span class="header-section-number">1</span> Introduction</h2>
<p>Motivate with:</p>
<ol type="1">
<li><p>Anecdotes:</p>
<ul>
<li>Quote stats on cart abandonment rates. Consumers can pick a preferred bluetooth speaker out of many brands (or a preferred color out of many options from the same brand), but then they may hesitate making the purchase.</li>
<li>no unusual reaction from consumers if you ask them “how likely are you to purchase?” Uncertainty about making a purchase “feels natural.”</li>
</ul></li>
<li><p>Psych findings:</p>
<ul>
<li>[possibly use] decoy effect: low purchase prob when coke machine by iteslf, but high coke and pepsi purchase prob when machines side-by-side,</li>
</ul></li>
<li><p>Practice:</p>
<ul>
<li>Brazell et al 2006 paper</li>
<li>Sawtooth’s implementation in Lighthouse Studio application</li>
</ul></li>
</ol>
<p>Describe: The dual-response framework asks for an immediate comparison (which of these things in front of you do you like best) and a hypothetical future scenario (if this product was available to purchase in the near future, would you purchase it). We provide a behavioral model that rationalizes use of the dual-response framework</p>
</section>
<section id="sec-model" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-model"><span class="header-section-number">2</span> Model</h2>
<section id="set-up" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="set-up"><span class="header-section-number">2.1</span> Set Up</h3>
<p>Consumer <span class="math inline">\(i=1,\ldots,N\)</span> derives utility from good <span class="math inline">\(j \in \mathcal{J}_i =  \lbrace 0,1,2,\ldots,J_i \rbrace\)</span> with utility <span class="math inline">\(u_{ij}\)</span> given by <span class="math display">\[
u_{ij} = h(\x_j, \bfbeta_i) + \eta_{ij}.
\]</span> where <span class="math inline">\(\x_j\)</span> is a length-<span class="math inline">\(P\)</span> column vector of good characteristics, <span class="math inline">\(\bfbeta_i\)</span> is a length-<span class="math inline">\(P\)</span> column vector of consumer-specific taste parameters, and <span class="math inline">\(\eta_{ij}\)</span> encapsulates factors known to the consumer but unobserved by the researcher. We take <span class="math inline">\(h(\x_j, \bfbeta_i) = \x_j'\bfbeta_i\)</span> but this specification is not required.</p>
<p>The “zero”-th (or “outside”) good is special and is associated with a zero vector of good characteristics (<span class="math inline">\(\x_0 = \mathbf{0}\)</span>) such that <span class="math inline">\(h(\x_0, \bfbeta_i)=0\)</span>. Consumers observe <span class="math inline">\(\x_j\)</span> and <span class="math inline">\(\eta_{ij}\)</span> for all “inside” goods (<span class="math inline">\(j \in \mathcal{J}^{+}_i \coloneqq \lbrace 1,2,\ldots,J_i \rbrace\)</span>), but they <em>do not</em> observe <span class="math inline">\(\eta_{i0}\)</span>.</p>
<p>The consumer first reports her preferred inside good, which is given by <span class="math display">\[
j^*_i = \underset{j \in \mathcal{J}^+}{\operatorname{arg max}} \ u_{ij}.
\]</span></p>
<p>The consumer then reports a value <span class="math inline">\(y_i\)</span> on a discrete qualitative scale <span class="math inline">\(w \in \mathcal{W} = \lbrace 1, \ldots, W \rbrace\)</span> to reflect the probability <span class="math inline">\(p_i\)</span> that she would purchase <span class="math inline">\(j^*\)</span>, i.e., that she prefers good <span class="math inline">\(j^*_i\)</span> to the outside good <span class="math inline">\(j=0\)</span>.</p>
<p>Let <span class="math inline">\(F\)</span> denote the cumulative distribution function associated with <span class="math inline">\(p_i\)</span>. Apportion the range of <span class="math inline">\(F\)</span> into a number <span class="math inline">\(W\)</span> of intervals <span class="math inline">\(\phi_w = \left[ \alpha_{w-1}, \alpha_w \right)\)</span>, where <span class="math inline">\(\alpha_0 = 0\)</span> and <span class="math inline">\(\alpha_W = 1\)</span>. We assume that consumers share the definition of the qualitative scale and thus understand these intervals, whereas <span class="math inline">\(\alpha_w\)</span> for <span class="math inline">\(0&lt;w&lt;W\)</span> are unobserved by the researcher and are to be estimated.</p>
<p>Let <span class="math inline">\(u_i^*\)</span> denote the utility of good <span class="math inline">\(j^*_i\)</span> for consumer <span class="math inline">\(i\)</span>. Consumers know <span class="math inline">\(u_i^*\)</span>, but do not know <span class="math inline">\(\eta_{i0}\)</span>, and thus the purchase probability from the consumer’s perspective is given by <span class="math display">\[
p_i = \Pr \left( \eta_{i0} &lt; u_i^* \right) = F\left( u_i^* \right).
\]</span></p>
<p>The act of reporting the interval <span class="math inline">\(y_i=w\)</span> into which <span class="math inline">\(p_i\)</span> falls, reveals that <span class="math inline">\(p_i \in \phi_{w\left(i\right)} = \left[\alpha_{w-1},\alpha_w\right)\)</span> and is therefore equivalent to reporting that <span class="math display">\[
u_i^* \in \left[
    F^{-1} \left( \alpha_{w_{i-1}} \right), \;
    F^{-1} \left( \alpha_{w_i}     \right)
\right].
\]</span></p>
</section>
<section id="probability-specification" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="probability-specification"><span class="header-section-number">2.2</span> Probability Specification</h3>
<p>We model <span class="math inline">\(\eta_{ij} \iid \text{Gumbel} \left( 0,1 \right)\)</span> with <span class="math inline">\(\eta_{ij}\)</span> assumed to be independent of both <span class="math inline">\(\x_j\)</span> and <span class="math inline">\(\eta_{ik}\)</span> for <span class="math inline">\(k \ne j\)</span>,<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>From the consumer’s perspective, her purchase probability is <span class="math display">\[
p_i = \Pr \left( \eta_{i0} &lt; u_i^* \right) = F_{\text{Gumble}\left(0,1\right)} \left( u_i^* \right)
\]</span> and, before she reports <span class="math inline">\(y_i\)</span>, the probability of reporting any particular value <span class="math inline">\(w\)</span> on the ordinal scale <span class="math inline">\(\Pr(y_i=w)\)</span> is given by <span class="math display">\[
\begin{aligned}
    \Pr(y_i=w)
    &amp;=
    F_{\text{Gumbel}\left(0,1\right)} \left( F^{-1}_{\text{Gumbel}\left(0,1\right)} \left( \alpha_w \right) \right) -
    F_{\text{Gumbel}\left(0,1\right)} \left( F^{-1}_{\text{Gumbel}\left(0,1\right)} \left( \alpha_{w-1} \right) \right) \\
    &amp;=
    \alpha_w - \alpha_{w-1}.
\end{aligned}
\]</span></p>
<p>From the researcher’s perspective, the unobserved likelihood of purchase is <span class="math display">\[
p_i = \Pr \left( \eta_{i0} - u_i^* &lt; 0 \right) = \Pr \left( \varepsilon_i &lt; 0 \right)
\]</span> where <span class="math inline">\(\varepsilon_i = \eta_{i0} - u_i^*\)</span>. As is well known,<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <span class="math inline">\(u_i^*\)</span> follows a Gumbel distribution with location parameter <span class="math inline">\(\overline{\mu}_i\)</span> and scale parameter <span class="math inline">\(1\)</span>, where <span id="eq-max-mu"><span class="math display">\[
\overline{\mu}_i = \ln \left( \sum_{j\in\mathcal{J}_i} \exp \left( {\x_j}'\bfbeta_i \right) \right).
\tag{1}\]</span></span> and so <span class="math inline">\(\varepsilon_i\)</span> follows a Logistic distribution with location parameter <span class="math inline">\(\overline{\mu}_i\)</span> and scale parameter <span class="math inline">\(1\)</span>. The unobserved choice probability is <span class="math display">\[
p_i = F_{\text{Logistic} \left( \overline{\mu}_i, 1 \right)} \left( \varepsilon_i \right).
\]</span></p>
<p>Therefore, the probability that consumer <span class="math inline">\(i\)</span> reports <span class="math inline">\(y_i=w\)</span> is <span class="math display">\[
\begin{aligned}
    \Pr \left( u_i^* \hspace{1ex} \text{s.t.} \hspace{1ex} p_i \in \phi_{w\left(i\right)} \right)
    &amp;= F_{\text{Logistic} \left( \overline{\mu}, 1 \right) } \left( F^{-1}_{\text{Gumbel} \left( 0, 1 \right) } \left( \alpha_{w\left(i\right)} \right) \right) -
       F_{\text{Logistic} \left( \overline{\mu}, 1 \right) } \left( F^{-1}_{\text{Gumbel} \left( 0, 1 \right) } \left( \alpha_{w\left(i\right)-1} \right) \right) \\
    &amp;= \frac{1}{1 - \exp \left( \overline{\mu} \right) \ln \alpha_{w\left(i\right)}} -
       \frac{1}{1 - \exp \left( \overline{\mu} \right) \ln \alpha_{w\left(i-1\right)}}
\end{aligned}
\]</span></p>
<!-- 
    &= \left( \alpha_{w\left(i\right)} \right)^{\exp \left( \overline{\mu} \right)} - 
       \left({\alpha_{w\left(i\right)-1}} \right)^{\exp \left( \overline{\mu} \right)}.
-->
</section>
</section>
<section id="sec-simstudy" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-simstudy"><span class="header-section-number">3</span> Simulation Study</h2>
<ol type="1">
<li>Agg MNL</li>
</ol>
<ul>
<li>Simulate data (<span class="math inline">\(\bfbeta_i = \bfbeta\)</span>), then:</li>
<li>recover parameters</li>
<li>compare to dichotomized dual-response</li>
<li>compare to constant-prob (if <span class="math inline">\(W=5\)</span> set <span class="math inline">\(\alpha\)</span>’s such that <span class="math inline">\(\Pr(y_i=w) = 1/5\)</span> )</li>
<li>or, instead of 1/W do the observed frequency</li>
</ul>
<ol type="1">
<li>HB MNL</li>
</ol>
<ul>
<li>Same 4 things as above</li>
</ul>
<ol type="1">
<li>Assessing <span class="math inline">\(\alpha\)</span> cut-points</li>
</ol>
<ul>
<li>May need to try extreme values for some <span class="math inline">\(\alpha\)</span>’s</li>
<li>What happens when different consumers have different interpretation of the <span class="math inline">\(W\)</span> categories such that <span class="math inline">\(\alpha\)</span>’s are not the same for all consumers?</li>
</ul>
</section>
<section id="sec-analysis" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-analysis"><span class="header-section-number">4</span> Empirical Analysis</h2>
<p>add</p>
</section>
<section id="sec-discussion" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="sec-discussion"><span class="header-section-number">5</span> Discussion</h2>
<p>Differs from <span class="citation" data-cites="Brazell_2006">(<a href="#ref-Brazell_2006" role="doc-biblioref">Brazell et al. 2006</a>)</span></p>
</section>
<section id="sec-conclusion" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="sec-conclusion"><span class="header-section-number">6</span> Conclusion</h2>
<p>add</p>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Brazell_2006" class="csl-entry" role="listitem">
Brazell, Jeff D., Christopher G. Diener, Ekaterina Karniouchina, William L. Moore, Válerie Séverin, and Pierre-Francois Uldry. 2006. <span>“The No-Choice Option and Dual Response Choice Designs.”</span> <em>Marketing Letters</em> 17 (4): 255–68. <a href="https://doi.org/10.1007/s11002-006-7943-8">https://doi.org/10.1007/s11002-006-7943-8</a>.
</div>
<div id="ref-Cardell_1997" class="csl-entry" role="listitem">
Cardell, N. Scott. 1997. <span>“Variance Components Structures for the Extreme-Value and Logistic Distributions with Application to Models of Heterogeneity.”</span> <em>Econometric Theory</em> 13 (2): 185–213. <a href="https://doi.org/10.1017/s0266466600005727">https://doi.org/10.1017/s0266466600005727</a>.
</div>
<div id="ref-Mcfadden_1981" class="csl-entry" role="listitem">
McFadden, Daniel L. 1981. <span>“Structural Discrete Probability Models Derived from Theories of Choice.”</span> In, 198–272. The MIT Press.
</div>
</div>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>This can be motivated by a framework in which <span class="math inline">\(u_0 = 0\)</span> and <span class="math inline">\(u_{ij} = {\x_j}'\bfbeta_i + \eta_{ij} - \eta_0\)</span> for <span class="math inline">\(j \in \mathcal{J}^{+}_i\)</span>. Here, <span class="math inline">\(\eta_0\)</span> captures the consumer’s uncertainty about their future tastes. Given that utilities are ordinal and <span class="math inline">\(\eta_0\)</span> is a common shock, it plays no role in the choice among the most preferred inside good <span class="math inline">\(j^* \in \mathcal{J}^{+}_i\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We note that, while the parametrization of <span class="math inline">\(\eta_0 \sim \text{Gumbel}\left(0,1\right)\)</span> preserves symmetry among the <span class="math inline">\(J+1\)</span> goods and is thus a natural choice, the framework can easily accommodate an alternative distribution for <span class="math inline">\(\eta_0\)</span>. For example, one could use an affine function of individual characteristics to accommodate individual-level variation in the propensity to prefer the outside good.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>See, e.g., <span class="citation" data-cites="Mcfadden_1981">(<a href="#ref-Mcfadden_1981" role="doc-biblioref">McFadden 1981</a>)</span> or <span class="citation" data-cites="Cardell_1997">(<a href="#ref-Cardell_1997" role="doc-biblioref">Cardell 1997</a>)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{bhalerao2024,
  author = {Bhalerao, Prachi and Yavorsky, Dan and Zheng, Geoffery},
  title = {Outside {Good} {Uncertainty}},
  date = {2024-08-22},
  langid = {en},
  abstract = {We provide a behavioral model in which consumers are able
    to identify their most-preferred option among a set of alternatives,
    but face uncertainty in their evalulation of the outside good. The
    model rationalizes the use of a dual-response framework in
    choice-based conjoint analysis and extends the evaluation of the
    purchase decision from binary to ordinal. A simulation study
    provides estimation routines for aggregate and Hierarhical Bayesian
    versions of the model, and demonstrates the model’s superior
    performance compared with the binary and heuristic approaches
    currently used by practioners. We also provide an empirical example
    from a choice-based conjoint analysis conducted in partnership with
    a consumer insights consultancy.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-bhalerao2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Bhalerao, Prachi, Dan Yavorsky, and Geoffery Zheng. 2024. <span>“Outside
Good Uncertainty.”</span> August 22, 2024.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>